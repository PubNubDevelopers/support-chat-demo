{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport { getData, getSanitizedData, intersect } from '..';\nimport { uncompress } from '../data';\nimport store from '../store';\n\nvar NimbleEmojiIndex = /*#__PURE__*/function () {\n  function NimbleEmojiIndex(data, set) {\n    _classCallCheck(this, NimbleEmojiIndex);\n\n    if (data.compressed) {\n      uncompress(data);\n    }\n\n    this.data = data || {};\n    this.set = set || null;\n    this.originalPool = {};\n    this.index = {};\n    this.emojis = {};\n    this.emoticons = {};\n    this.customEmojisList = [];\n    this.buildIndex();\n  }\n\n  _createClass(NimbleEmojiIndex, [{\n    key: \"buildIndex\",\n    value: function buildIndex() {\n      var _this = this;\n\n      var _loop = function _loop(emoji) {\n        var emojiData = _this.data.emojis[emoji],\n            short_names = emojiData.short_names,\n            emoticons = emojiData.emoticons,\n            skin_variations = emojiData.skin_variations,\n            id = short_names[0];\n\n        if (emoticons) {\n          emoticons.forEach(function (emoticon) {\n            if (_this.emoticons[emoticon]) {\n              return;\n            }\n\n            _this.emoticons[emoticon] = id;\n          });\n        } // If skin variations include them\n\n\n        if (skin_variations) {\n          _this.emojis[id] = {};\n\n          for (var skinTone = 1; skinTone <= 6; skinTone++) {\n            _this.emojis[id][skinTone] = getSanitizedData({\n              id: id,\n              skin: skinTone\n            }, skinTone, _this.set, _this.data);\n          }\n        } else {\n          _this.emojis[id] = getSanitizedData(id, null, _this.set, _this.data);\n        }\n\n        _this.originalPool[id] = emojiData;\n      };\n\n      for (var emoji in this.data.emojis) {\n        _loop(emoji);\n      }\n    }\n  }, {\n    key: \"clearCustomEmojis\",\n    value: function clearCustomEmojis(pool) {\n      var _this2 = this;\n\n      this.customEmojisList.forEach(function (emoji) {\n        var emojiId = emoji.id || emoji.short_names[0];\n        delete pool[emojiId];\n        delete _this2.emojis[emojiId];\n      });\n    }\n  }, {\n    key: \"addCustomToPool\",\n    value: function addCustomToPool(custom, pool) {\n      var _this3 = this;\n\n      if (this.customEmojisList.length) this.clearCustomEmojis(pool);\n      custom.forEach(function (emoji) {\n        var emojiId = emoji.id || emoji.short_names[0];\n\n        if (emojiId && !pool[emojiId]) {\n          pool[emojiId] = getData(emoji, null, null, _this3.data);\n          _this3.emojis[emojiId] = getSanitizedData(emoji, null, null, _this3.data);\n        }\n      });\n      this.customEmojisList = custom;\n      this.index = {};\n    }\n  }, {\n    key: \"search\",\n    value: function search(value) {\n      var _this4 = this;\n\n      var _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n          emojisToShowFilter = _ref.emojisToShowFilter,\n          maxResults = _ref.maxResults,\n          include = _ref.include,\n          exclude = _ref.exclude,\n          _ref$custom = _ref.custom,\n          custom = _ref$custom === void 0 ? [] : _ref$custom;\n\n      if (this.customEmojisList != custom) this.addCustomToPool(custom, this.originalPool);\n      var skinTone = store.get('skin') || 1;\n      maxResults || (maxResults = 75);\n      include || (include = []);\n      exclude || (exclude = []);\n      var results = null,\n          pool = this.originalPool;\n\n      if (value.length) {\n        if (value == '-' || value == '-1') {\n          return [this.emojis['-1'][skinTone]];\n        }\n\n        var values = value.toLowerCase().split(/[\\s|,|\\-|_]+/),\n            allResults = [];\n\n        if (values.length > 2) {\n          values = [values[0], values[1]];\n        }\n\n        if (include.length || exclude.length) {\n          pool = {};\n          this.data.categories.forEach(function (category) {\n            var isIncluded = include && include.length ? include.indexOf(category.id) > -1 : true;\n            var isExcluded = exclude && exclude.length ? exclude.indexOf(category.id) > -1 : false;\n\n            if (!isIncluded || isExcluded) {\n              return;\n            }\n\n            category.emojis.forEach(function (emojiId) {\n              return pool[emojiId] = _this4.data.emojis[emojiId];\n            });\n          });\n\n          if (custom.length) {\n            var customIsIncluded = include && include.length ? include.indexOf('custom') > -1 : true;\n            var customIsExcluded = exclude && exclude.length ? exclude.indexOf('custom') > -1 : false;\n\n            if (customIsIncluded && !customIsExcluded) {\n              this.addCustomToPool(custom, pool);\n            }\n          }\n        }\n\n        allResults = values.map(function (value) {\n          var aPool = pool,\n              aIndex = _this4.index,\n              length = 0;\n\n          for (var charIndex = 0; charIndex < value.length; charIndex++) {\n            var _char = value[charIndex];\n            length++;\n            aIndex[_char] || (aIndex[_char] = {});\n            aIndex = aIndex[_char];\n\n            if (!aIndex.results) {\n              (function () {\n                var scores = {};\n                aIndex.results = [];\n                aIndex.pool = {};\n\n                for (var id in aPool) {\n                  var emoji = aPool[id],\n                      search = emoji.search,\n                      sub = value.substr(0, length),\n                      subIndex = search.indexOf(sub);\n\n                  if (subIndex != -1) {\n                    var score = subIndex + 1;\n                    if (sub == id) score = 0;\n\n                    if (_this4.emojis[id] && _this4.emojis[id][skinTone]) {\n                      aIndex.results.push(_this4.emojis[id][skinTone]);\n                    } else {\n                      aIndex.results.push(_this4.emojis[id]);\n                    }\n\n                    aIndex.pool[id] = emoji;\n                    scores[id] = score;\n                  }\n                }\n\n                aIndex.results.sort(function (a, b) {\n                  var aScore = scores[a.id],\n                      bScore = scores[b.id];\n\n                  if (aScore == bScore) {\n                    return a.id.localeCompare(b.id);\n                  } else {\n                    return aScore - bScore;\n                  }\n                });\n              })();\n            }\n\n            aPool = aIndex.pool;\n          }\n\n          return aIndex.results;\n        }).filter(function (a) {\n          return a;\n        });\n\n        if (allResults.length > 1) {\n          results = intersect.apply(null, allResults);\n        } else if (allResults.length) {\n          results = allResults[0];\n        } else {\n          results = [];\n        }\n      }\n\n      if (results) {\n        if (emojisToShowFilter) {\n          results = results.filter(function (result) {\n            return emojisToShowFilter(pool[result.id]);\n          });\n        }\n\n        if (results && results.length > maxResults) {\n          results = results.slice(0, maxResults);\n        }\n      }\n\n      return results;\n    }\n  }]);\n\n  return NimbleEmojiIndex;\n}();\n\nexport { NimbleEmojiIndex as default };","map":{"version":3,"sources":["/Users/chandler/Desktop/support-chat-demo/client/node_modules/emoji-mart/dist-es/utils/emoji-index/nimble-emoji-index.js"],"names":["_classCallCheck","_createClass","getData","getSanitizedData","intersect","uncompress","store","NimbleEmojiIndex","data","set","compressed","originalPool","index","emojis","emoticons","customEmojisList","buildIndex","key","value","_this","_loop","emoji","emojiData","short_names","skin_variations","id","forEach","emoticon","skinTone","skin","clearCustomEmojis","pool","_this2","emojiId","addCustomToPool","custom","_this3","length","search","_this4","_ref","arguments","undefined","emojisToShowFilter","maxResults","include","exclude","_ref$custom","get","results","values","toLowerCase","split","allResults","categories","category","isIncluded","indexOf","isExcluded","customIsIncluded","customIsExcluded","map","aPool","aIndex","charIndex","_char","scores","sub","substr","subIndex","score","push","sort","a","b","aScore","bScore","localeCompare","filter","apply","result","slice","default"],"mappings":"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","sourcesContent":["import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport { getData, getSanitizedData, intersect } from '..';\nimport { uncompress } from '../data';\nimport store from '../store';\n\nvar NimbleEmojiIndex =\n/*#__PURE__*/\nfunction () {\n  function NimbleEmojiIndex(data, set) {\n    _classCallCheck(this, NimbleEmojiIndex);\n\n    if (data.compressed) {\n      uncompress(data);\n    }\n\n    this.data = data || {};\n    this.set = set || null;\n    this.originalPool = {};\n    this.index = {};\n    this.emojis = {};\n    this.emoticons = {};\n    this.customEmojisList = [];\n    this.buildIndex();\n  }\n\n  _createClass(NimbleEmojiIndex, [{\n    key: \"buildIndex\",\n    value: function buildIndex() {\n      var _this = this;\n\n      var _loop = function _loop(emoji) {\n        var emojiData = _this.data.emojis[emoji],\n            short_names = emojiData.short_names,\n            emoticons = emojiData.emoticons,\n            skin_variations = emojiData.skin_variations,\n            id = short_names[0];\n\n        if (emoticons) {\n          emoticons.forEach(function (emoticon) {\n            if (_this.emoticons[emoticon]) {\n              return;\n            }\n\n            _this.emoticons[emoticon] = id;\n          });\n        } // If skin variations include them\n\n\n        if (skin_variations) {\n          _this.emojis[id] = {};\n\n          for (var skinTone = 1; skinTone <= 6; skinTone++) {\n            _this.emojis[id][skinTone] = getSanitizedData({\n              id: id,\n              skin: skinTone\n            }, skinTone, _this.set, _this.data);\n          }\n        } else {\n          _this.emojis[id] = getSanitizedData(id, null, _this.set, _this.data);\n        }\n\n        _this.originalPool[id] = emojiData;\n      };\n\n      for (var emoji in this.data.emojis) {\n        _loop(emoji);\n      }\n    }\n  }, {\n    key: \"clearCustomEmojis\",\n    value: function clearCustomEmojis(pool) {\n      var _this2 = this;\n\n      this.customEmojisList.forEach(function (emoji) {\n        var emojiId = emoji.id || emoji.short_names[0];\n        delete pool[emojiId];\n        delete _this2.emojis[emojiId];\n      });\n    }\n  }, {\n    key: \"addCustomToPool\",\n    value: function addCustomToPool(custom, pool) {\n      var _this3 = this;\n\n      if (this.customEmojisList.length) this.clearCustomEmojis(pool);\n      custom.forEach(function (emoji) {\n        var emojiId = emoji.id || emoji.short_names[0];\n\n        if (emojiId && !pool[emojiId]) {\n          pool[emojiId] = getData(emoji, null, null, _this3.data);\n          _this3.emojis[emojiId] = getSanitizedData(emoji, null, null, _this3.data);\n        }\n      });\n      this.customEmojisList = custom;\n      this.index = {};\n    }\n  }, {\n    key: \"search\",\n    value: function search(value) {\n      var _this4 = this;\n\n      var _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n          emojisToShowFilter = _ref.emojisToShowFilter,\n          maxResults = _ref.maxResults,\n          include = _ref.include,\n          exclude = _ref.exclude,\n          _ref$custom = _ref.custom,\n          custom = _ref$custom === void 0 ? [] : _ref$custom;\n\n      if (this.customEmojisList != custom) this.addCustomToPool(custom, this.originalPool);\n      var skinTone = store.get('skin') || 1;\n      maxResults || (maxResults = 75);\n      include || (include = []);\n      exclude || (exclude = []);\n      var results = null,\n          pool = this.originalPool;\n\n      if (value.length) {\n        if (value == '-' || value == '-1') {\n          return [this.emojis['-1'][skinTone]];\n        }\n\n        var values = value.toLowerCase().split(/[\\s|,|\\-|_]+/),\n            allResults = [];\n\n        if (values.length > 2) {\n          values = [values[0], values[1]];\n        }\n\n        if (include.length || exclude.length) {\n          pool = {};\n          this.data.categories.forEach(function (category) {\n            var isIncluded = include && include.length ? include.indexOf(category.id) > -1 : true;\n            var isExcluded = exclude && exclude.length ? exclude.indexOf(category.id) > -1 : false;\n\n            if (!isIncluded || isExcluded) {\n              return;\n            }\n\n            category.emojis.forEach(function (emojiId) {\n              return pool[emojiId] = _this4.data.emojis[emojiId];\n            });\n          });\n\n          if (custom.length) {\n            var customIsIncluded = include && include.length ? include.indexOf('custom') > -1 : true;\n            var customIsExcluded = exclude && exclude.length ? exclude.indexOf('custom') > -1 : false;\n\n            if (customIsIncluded && !customIsExcluded) {\n              this.addCustomToPool(custom, pool);\n            }\n          }\n        }\n\n        allResults = values.map(function (value) {\n          var aPool = pool,\n              aIndex = _this4.index,\n              length = 0;\n\n          for (var charIndex = 0; charIndex < value.length; charIndex++) {\n            var _char = value[charIndex];\n            length++;\n            aIndex[_char] || (aIndex[_char] = {});\n            aIndex = aIndex[_char];\n\n            if (!aIndex.results) {\n              (function () {\n                var scores = {};\n                aIndex.results = [];\n                aIndex.pool = {};\n\n                for (var id in aPool) {\n                  var emoji = aPool[id],\n                      search = emoji.search,\n                      sub = value.substr(0, length),\n                      subIndex = search.indexOf(sub);\n\n                  if (subIndex != -1) {\n                    var score = subIndex + 1;\n                    if (sub == id) score = 0;\n\n                    if (_this4.emojis[id] && _this4.emojis[id][skinTone]) {\n                      aIndex.results.push(_this4.emojis[id][skinTone]);\n                    } else {\n                      aIndex.results.push(_this4.emojis[id]);\n                    }\n\n                    aIndex.pool[id] = emoji;\n                    scores[id] = score;\n                  }\n                }\n\n                aIndex.results.sort(function (a, b) {\n                  var aScore = scores[a.id],\n                      bScore = scores[b.id];\n\n                  if (aScore == bScore) {\n                    return a.id.localeCompare(b.id);\n                  } else {\n                    return aScore - bScore;\n                  }\n                });\n              })();\n            }\n\n            aPool = aIndex.pool;\n          }\n\n          return aIndex.results;\n        }).filter(function (a) {\n          return a;\n        });\n\n        if (allResults.length > 1) {\n          results = intersect.apply(null, allResults);\n        } else if (allResults.length) {\n          results = allResults[0];\n        } else {\n          results = [];\n        }\n      }\n\n      if (results) {\n        if (emojisToShowFilter) {\n          results = results.filter(function (result) {\n            return emojisToShowFilter(pool[result.id]);\n          });\n        }\n\n        if (results && results.length > maxResults) {\n          results = results.slice(0, maxResults);\n        }\n      }\n\n      return results;\n    }\n  }]);\n\n  return NimbleEmojiIndex;\n}();\n\nexport { NimbleEmojiIndex as default };"]},"metadata":{},"sourceType":"module"}